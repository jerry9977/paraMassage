{% extends "form/layout.html"%}

{% block title %}Client Intake Form{% endblock %}

{%block head_extra%}
<style>
    .colorButtons {
        display: block;
        margin: 20px 0;
    }

    canvas {
        cursor: crosshair;
        border: 1px solid black;
    }

    div#sidebar {
        position: absolute;
        left: 0;
        width: 150px;
        padding: 20px 20px;
        top: 0;
    }

    canvas#canvas {
        left: 150px;
        top: 45px;
    }

    .btn {
        margin-bottom: 10px;
        width: 100%;
    }
    /* input {
        width: 100%;
        margin-bottom: 10px;
    } */

    .input-group {
        margin-bottom: 10px;
    }

    .toolsButtons .btn {
        width: 48%;
    }

    .sizeButtons .btn {
        width: 48%;
    }

    .colorpicker {
        background: transparent;
        height: 40px;
    }
</style>
{{ form.media }}
{%endblock%}

{%block content%}
<div id="form-card">
    <div class="cutsomer-form-wrapper">
        <div style="margin-bottom: 30px;">
            <div style="color:#959595; font-size: 12px; ">* Required information</div>
            {% for error in form.non_field_errors %}
                    <span style="color:red">{{ error|escape }}</span>
            {% endfor %}
        </div>
        <!-- {{form}} -->
        <!-- <input type="color"  class="js-color-picker  color-picker"> -->
        <!-- <input type="range" class="js-line-range" min="1" max="72" value="1"> -->
        <!-- <label class="js-range-value">1</label>Px -->
        <canvas class="js-paint  paint-canvas" width="600" height="300"></canvas>

        <form method="POST" novalidate>
            {% csrf_token %}
            <div class="grid"  style="row-gap: 20px;">
                

                {% for field in form %}
                    
   
                    {% if field.errors %}
                        <div class="g-col-12 g-col-md-6">
                            <label for="{{ field.id_for_label }}" class="form-label fw-semibold">{{field.label}} {% if field.field.required %}<span style="color:red;">*</span>{% endif %}</label>
                            <input type="{{ field.field.widget.input_type }}" class="form-control is-invalid" id="{{ field.id_for_label }}" name="{{field.html_name}}" value="{{field.value|default_if_none:''}}">
                            <div class="invalid-feedback">
                                {% for error in field.errors %}
                                    {{ error|escape }}
                                {% endfor %}
                            </div>
                        </div>
                        
                        
                    {% elif field.value %}
                        <div class="g-col-12 g-col-md-6">
                            <label for="{{ field.id_for_label }}" class="form-label fw-semibold">{{field.label}} {% if field.field.required %}<span style="color:red;">*</span>{% endif %}</label>
                            <input type="{{ field.field.widget.input_type }}" class="form-control is-valid" id="{{ field.id_for_label }}" name="{{field.html_name}}" value="{{field.value|default_if_none:''}}">
                            
                        </div>
                        
                    {% else %}
                        <div class="g-col-12 g-col-md-6">
                            <label for="{{ field.id_for_label }}" class="form-label fw-semibold">{{field.label}} {% if field.field.required %}<span style="color:red;">*</span>{% endif %}</label>
                            <input type="{{ field.field.widget.input_type }}" class="form-control" id="{{ field.id_for_label }}" name="{{field.html_name}}" value="{{field.value|default_if_none:''}}">
                        </div>
                        
                    {% endif %}
                    
                {% endfor %}

                
            </div>
            <div style="margin-top: 40px;">
                <button class="btn btn-primary" type="submit" >Submit</button>
            </div>
        </form>
        
    </div>
</div>


<script>
    const paintCanvas = document.querySelector( '.js-paint' );
    const context = paintCanvas.getContext( '2d' );
    context.lineCap = 'round';

    const colorPicker = document.querySelector( '.js-color-picker');



    const lineWidthRange = document.querySelector( '.js-line-range' );
    const lineWidthLabel = document.querySelector( '.js-range-value' );

    context.strokeStyle = '#000000'; 
    context.lineWidth = 1;
    let x = 0, y = 0;
    let isMouseDown = false;

    const stopDrawing = () => { isMouseDown = false; }
    const startDrawing = event => {
        isMouseDown = true;   
    [x, y] = [event.offsetX, event.offsetY];  
    }
    const drawLine = event => {
        if ( isMouseDown ) {
            const newX = event.offsetX;
            const newY = event.offsetY;
            context.beginPath();
            context.moveTo( x, y );
            context.lineTo( newX, newY );
            context.stroke();
            //[x, y] = [newX, newY];
            x = newX;
            y = newY;
        }
    }

    paintCanvas.addEventListener( 'mousedown', startDrawing );
    paintCanvas.addEventListener( 'mousemove', drawLine );
    paintCanvas.addEventListener( 'mouseup', stopDrawing );
    paintCanvas.addEventListener( 'mouseout', stopDrawing );
</script>
{%endblock%}
